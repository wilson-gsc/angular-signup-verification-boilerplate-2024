import{d as A,e as K,g as y,i as x}from"./chunk-6YFZBJY7.js";import{A as i,B as l,C as F,D as b,E as D,G as a,H as u,L as S,Q as k,R,S as _,V as j,aa as T,ba as w,ca as V,da as G,ea as O,fa as B,ga as q,ka as $,l as v,ma as z,n as M,o as L,oa as H,q as m,qa as J,r as s,ra as C,s as h,t as g,ta as E,u as c,w as d,z as n}from"./chunk-G6OFTRNW.js";var Z=e=>["/departments/edit",e];function ee(e,p){e&1&&l(0,"span",14)}function te(e,p){e&1&&(n(0,"span"),a(1,"Delete"),i())}function ie(e,p){if(e&1){let t=F();n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),i(),n(5,"td",9)(6,"a",11),a(7,"Edit"),i(),n(8,"button",12),b("click",function(){let r=M(t).$implicit,f=D();return L(f.deleteDepartment(r.id))}),c(9,ee,1,0,"span",13)(10,te,2,0,"span",8),i()()()}if(e&2){let t=p.$implicit;m(2),u(t.name),m(2),u(t.description),m(2),d("routerLink",S(6,Z,t.id)),m(2),d("disabled",t.isDeleting),m(),d("ngIf",t.isDeleting),m(),d("ngIf",!t.isDeleting)}}function ne(e,p){e&1&&(n(0,"tr")(1,"td",15),a(2,"No departments found"),i()())}var P=(()=>{class e{constructor(t){this.departmentService=t,this.departments=[]}ngOnInit(){this.departmentService.getAll().subscribe(t=>this.departments=t)}deleteDepartment(t){let o=this.departments.find(r=>r.id===t);o.isDeleting=!0,this.departmentService.delete(t).subscribe(()=>this.departments=this.departments.filter(r=>r.id!==t))}static{this.\u0275fac=function(o){return new(o||e)(s(y))}}static{this.\u0275cmp=h({type:e,selectors:[["ng-component"]],standalone:!1,decls:21,vars:2,consts:[[1,"p-4"],[1,"container"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"table-responsive"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"text-right"],["routerLink","/departments/add",1,"btn","btn-primary"],[1,"btn","btn-sm","btn-primary","mr-1",3,"routerLink"],[1,"btn","btn-sm","btn-danger",3,"click","disabled"],["class","spinner-border spinner-border-sm",4,"ngIf"],[1,"spinner-border","spinner-border-sm"],["colspan","3",1,"text-center"]],template:function(o,r){o&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),a(4,"Departments"),i(),n(5,"div",4)(6,"div",5)(7,"table",6)(8,"thead")(9,"tr")(10,"th"),a(11,"Name"),i(),n(12,"th"),a(13,"Description"),i(),l(14,"th"),i()(),n(15,"tbody"),c(16,ie,11,8,"tr",7)(17,ne,3,0,"tr",8),i()()(),n(18,"div",9)(19,"a",10),a(20,"Add Department"),i()()()()()()),o&2&&(m(16),d("ngForOf",r.departments),m(),d("ngIf",!(r.departments!=null&&r.departments.length)))},dependencies:[R,_,C],encapsulation:2})}}return e})();var re=e=>({"is-invalid":e});function oe(e,p){e&1&&(n(0,"div"),a(1,"Name is required"),i())}function ae(e,p){if(e&1&&(n(0,"div",13),c(1,oe,2,0,"div",14),i()),e&2){let t=D();m(),d("ngIf",t.f.name.errors.required)}}var N=(()=>{class e{constructor(t,o,r,f,U){this.formBuilder=t,this.route=o,this.router=r,this.departmentService=f,this.alertService=U}ngOnInit(){this.id=this.route.snapshot.params.id,this.isAddMode=!this.id,this.form=this.formBuilder.group({name:["",w.required],description:[""]}),this.isAddMode||this.departmentService.getById(this.id).subscribe(t=>this.form.patchValue(t))}get f(){return this.form.controls}onSubmit(){this.form.invalid||(this.isAddMode?this.createDepartment():this.updateDepartment())}createDepartment(){this.departmentService.create(this.form.value).subscribe({next:()=>{this.alertService.success("Department created successfully",{keepAfterRouteChange:!0}),this.router.navigate(["/departments"])},error:t=>this.alertService.error(t)})}updateDepartment(){this.departmentService.update(this.id,this.form.value).subscribe({next:()=>{this.alertService.success("Department updated successfully",{keepAfterRouteChange:!0}),this.router.navigate(["/departments"])},error:t=>this.alertService.error(t)})}static{this.\u0275fac=function(o){return new(o||e)(s($),s(H),s(J),s(y),s(K))}}static{this.\u0275cmp=h({type:e,selectors:[["ng-component"]],standalone:!1,decls:21,vars:7,consts:[[1,"p-4"],[1,"container"],[1,"card"],[1,"card-header"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"form-group"],["type","text","formControlName","name",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["formControlName","description",1,"form-control"],[1,"text-center"],["type","submit",1,"btn","btn-primary","mr-1",3,"disabled"],["routerLink","/departments",1,"btn","btn-secondary"],[1,"invalid-feedback"],[4,"ngIf"]],template:function(o,r){o&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),a(4),i(),n(5,"div",4)(6,"form",5),b("ngSubmit",function(){return r.onSubmit()}),n(7,"div",6)(8,"label"),a(9,"Name"),i(),l(10,"input",7),c(11,ae,2,1,"div",8),i(),n(12,"div",6)(13,"label"),a(14,"Description"),i(),l(15,"textarea",9),i(),n(16,"div",10)(17,"button",11),a(18,"Save"),i(),n(19,"a",12),a(20,"Cancel"),i()()()()()()()),o&2&&(m(4),u(r.isAddMode?"Add Department":"Edit Department"),m(2),d("formGroup",r.form),m(4),d("ngClass",S(5,re,r.f.name.touched&&r.f.name.errors)),m(),d("ngIf",r.f.name.touched&&r.f.name.errors),m(6),d("disabled",r.form.invalid))},dependencies:[k,_,O,T,V,G,B,q,C],encapsulation:2})}}return e})();var me=[{path:"",component:P,canActivate:[x]},{path:"add",component:N,canActivate:[x],data:{roles:[A.Admin]}},{path:"edit/:id",component:N,canActivate:[x],data:{roles:[A.Admin]}}],Q=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275mod=g({type:e})}static{this.\u0275inj=v({imports:[E.forChild(me),E]})}}return e})();var Ae=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275mod=g({type:e})}static{this.\u0275inj=v({imports:[j,z,Q]})}}return e})();export{Ae as DepartmentsModule};
