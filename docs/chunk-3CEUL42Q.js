import{d as te,e as I,h as x,i as F}from"./chunk-5A6XT7RQ.js";import{A as i,B as k,C as N,D as v,E as p,G as n,H as w,I as A,L as u,M,N as T,O as R,P as O,Q as _,R as V,S,T as D,U as B,V as J,aa as G,ba as P,ca as $,da as q,ea as z,fa as H,ga as K,ha as Q,ia as U,ja as X,ka as Y,l as g,ma as Z,n as E,o as W,oa as b,q as l,qa as ee,r as d,ra as C,s as h,t as y,ta as j,u as c,w as s,z as o}from"./chunk-G6OFTRNW.js";var ce=e=>["/workflows",e,"create"],pe=(e,m,t)=>({"badge badge-warning":e,"badge badge-success":m,"badge badge-danger":t});function fe(e,m){if(e&1){let t=N();o(0,"button",12),v("click",function(){E(t);let r=p().$implicit,f=p();return W(f.updateStatus(r.id,"Approved"))}),n(1,"Approve"),i()}}function ue(e,m){if(e&1){let t=N();o(0,"button",13),v("click",function(){E(t);let r=p().$implicit,f=p();return W(f.updateStatus(r.id,"Rejected"))}),n(1,"Reject"),i()}}function ve(e,m){if(e&1&&(o(0,"tr")(1,"td"),n(2),i(),o(3,"td")(4,"span",9),n(5),i()(),o(6,"td"),n(7),T(8,"json"),i(),o(9,"td"),n(10),T(11,"date"),i(),o(12,"td",7),c(13,fe,2,0,"button",10)(14,ue,2,0,"button",11),i()()),e&2){let t=m.$implicit;l(2),w(t.type),l(2),s("ngClass",M(12,pe,t.status==="Pending",t.status==="Approved",t.status==="Rejected")),l(),w(t.status),l(2),w(R(8,7,t.details)),l(3),w(O(11,9,t.createdAt,"medium")),l(3),s("ngIf",t.status==="Pending"),l(),s("ngIf",t.status==="Pending")}}function we(e,m){e&1&&(o(0,"tr")(1,"td",14),n(2,"No workflows found"),i()())}var ie=(()=>{class e{constructor(t,a,r){this.route=t,this.workflowService=a,this.alertService=r,this.workflows=[]}ngOnInit(){this.employeeId=this.route.snapshot.params.employeeId,this.workflowService.getByEmployeeId(this.employeeId).subscribe(t=>this.workflows=t)}updateStatus(t,a){this.workflowService.updateStatus(t,a).subscribe({next:()=>{this.alertService.success(`Workflow ${a} successfully`),this.workflowService.getByEmployeeId(this.employeeId).subscribe(r=>this.workflows=r)},error:r=>this.alertService.error(r)})}static{this.\u0275fac=function(a){return new(a||e)(d(b),d(x),d(I))}}static{this.\u0275cmp=h({type:e,selectors:[["ng-component"]],standalone:!1,decls:23,vars:6,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[1,"table-responsive"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"text-right"],[1,"btn","btn-primary",3,"routerLink"],[3,"ngClass"],["class","btn btn-sm btn-success mr-1",3,"click",4,"ngIf"],["class","btn btn-sm btn-danger",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-success","mr-1",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"],["colspan","5",1,"text-center"]],template:function(a,r){a&1&&(o(0,"div",0)(1,"h3",1),n(2),i(),o(3,"div",2)(4,"div",3)(5,"table",4)(6,"thead")(7,"tr")(8,"th"),n(9,"Type"),i(),o(10,"th"),n(11,"Status"),i(),o(12,"th"),n(13,"Details"),i(),o(14,"th"),n(15,"Created"),i(),k(16,"th"),i()(),o(17,"tbody"),c(18,ve,15,16,"tr",5)(19,we,3,0,"tr",6),i()()(),o(20,"div",7)(21,"a",8),n(22,"Create Workflow"),i()()()()),a&2&&(l(2),A("Workflows for Employee ",r.employeeId,""),l(16),s("ngForOf",r.workflows),l(),s("ngIf",!(r.workflows!=null&&r.workflows.length)),l(2),s("routerLink",u(4,ce,r.employeeId)))},dependencies:[_,V,S,C,B,D],encapsulation:2})}}return e})();var oe=e=>({"is-invalid":e}),ge=e=>["/workflows",e];function he(e,m){e&1&&(o(0,"div"),n(1,"Type is required"),i())}function ye(e,m){if(e&1&&(o(0,"div",15),c(1,he,2,0,"div",16),i()),e&2){let t=p();l(),s("ngIf",t.f.type.errors.required)}}function ke(e,m){e&1&&(o(0,"div"),n(1,"Invalid JSON format"),i())}function _e(e,m){if(e&1&&(o(0,"div",15),c(1,ke,2,0,"div",16),i()),e&2){let t=p();l(),s("ngIf",t.f.details.errors.invalidJson)}}var re=(()=>{class e{constructor(t,a,r,f,ae){this.formBuilder=t,this.route=a,this.router=r,this.workflowService=f,this.alertService=ae}ngOnInit(){this.employeeId=this.route.snapshot.params.employeeId,this.form=this.formBuilder.group({type:["",P.required],details:["",[this.jsonValidator()]]})}get f(){return this.form.controls}jsonValidator(){return t=>{if(!t.value)return null;try{return JSON.parse(t.value),null}catch{return{invalidJson:!0}}}}onSubmit(){if(this.form.invalid)return;let t={employeeId:this.employeeId,type:this.form.value.type,details:this.form.value.details?JSON.parse(this.form.value.details):null};this.workflowService.create(t).subscribe({next:()=>{this.alertService.success("Workflow created successfully",{keepAfterRouteChange:!0}),this.router.navigate(["/workflows",this.employeeId])},error:a=>this.alertService.error(a)})}static{this.\u0275fac=function(a){return new(a||e)(d(Y),d(b),d(ee),d(x),d(I))}}static{this.\u0275cmp=h({type:e,selectors:[["ng-component"]],standalone:!1,decls:28,vars:13,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"form-group"],["formControlName","type",1,"form-control",3,"ngClass"],["value",""],["value","Onboarding"],["value","DepartmentChange"],["value","Termination"],["class","invalid-feedback",4,"ngIf"],["formControlName","details",1,"form-control",3,"ngClass"],[1,"text-center"],["type","submit",1,"btn","btn-primary","mr-1",3,"disabled"],[1,"btn","btn-secondary",3,"routerLink"],[1,"invalid-feedback"],[4,"ngIf"]],template:function(a,r){a&1&&(o(0,"div",0)(1,"h3",1),n(2,"Create Workflow"),i(),o(3,"div",2)(4,"form",3),v("ngSubmit",function(){return r.onSubmit()}),o(5,"div",4)(6,"label"),n(7,"Type"),i(),o(8,"select",5)(9,"option",6),n(10,"Select Type"),i(),o(11,"option",7),n(12,"Onboarding"),i(),o(13,"option",8),n(14,"Department Change"),i(),o(15,"option",9),n(16,"Termination"),i()(),c(17,ye,2,1,"div",10),i(),o(18,"div",4)(19,"label"),n(20,"Details (JSON)"),i(),k(21,"textarea",11),c(22,_e,2,1,"div",10),i(),o(23,"div",12)(24,"button",13),n(25,"Create"),i(),o(26,"a",14),n(27,"Cancel"),i()()()()()),a&2&&(l(4),s("formGroup",r.form),l(4),s("ngClass",u(7,oe,r.f.type.touched&&r.f.type.errors)),l(9),s("ngIf",r.f.type.touched&&r.f.type.errors),l(4),s("ngClass",u(9,oe,r.f.details.touched&&r.f.details.errors)),l(),s("ngIf",r.f.details.touched&&r.f.details.errors),l(2),s("disabled",r.form.invalid),l(2),s("routerLink",u(11,ge,r.employeeId)))},dependencies:[_,S,z,U,X,G,Q,$,q,H,K,C],encapsulation:2})}}return e})();var Se=[{path:":employeeId",component:ie,canActivate:[F]},{path:":employeeId/create",component:re,canActivate:[F],data:{roles:[te.Admin]}}],ne=(()=>{class e{static{this.\u0275fac=function(a){return new(a||e)}}static{this.\u0275mod=y({type:e})}static{this.\u0275inj=g({imports:[j.forChild(Se),j]})}}return e})();var Be=(()=>{class e{static{this.\u0275fac=function(a){return new(a||e)}}static{this.\u0275mod=y({type:e})}static{this.\u0275inj=g({imports:[J,Z,ne]})}}return e})();export{Be as WorkflowsModule};
