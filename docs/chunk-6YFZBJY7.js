import{W as p,a as c,b as l,c as b,d as g,f as m,g as j,i as $,k as n,m as a,qa as d}from"./chunk-G6OFTRNW.js";var i={production:!1,apiUrl:"http://localhost:4000"};var s=`${i.apiUrl}/accounts`,I=(()=>{class e{constructor(t,r){this.router=t,this.http=r,this.accountSubject=new g(JSON.parse(localStorage.getItem("account")??"null")),this.account=this.accountSubject.asObservable()}get accountValue(){return this.accountSubject.value}login(t,r){return this.http.post(`${s}/authenticate`,{email:t,password:r},{withCredentials:!0}).pipe(m(o=>(this.accountSubject.next(o),this.startRefreshTokenTimer(),o)))}logout(){this.http.post(`${s}/revoke-token`,{},{withCredentials:!0}).subscribe(),this.stopRefreshTokenTimer(),this.accountSubject.next(null),this.router.navigate(["/account/login"])}refreshToken(){return this.http.post(`${s}/refresh-token`,{},{withCredentials:!0}).pipe(m(t=>(this.accountSubject.next(t),this.startRefreshTokenTimer(),t)))}register(t){return this.http.post(`${s}/register`,t)}verifyEmail(t){return this.http.post(`${s}/verify-email`,{token:t})}forgotPassword(t){return this.http.post(`${s}/forgot-password`,{email:t})}validateResetToken(t){return this.http.post(`${s}/validate-reset-token`,{token:t})}resetPassword(t,r,o){return this.http.post(`${s}/reset-password`,{token:t,password:r,confirmPassword:o})}getAll(){return this.http.get(s)}getById(t){return this.http.get(`${s}/${t}`)}create(t){return this.http.post(s,t)}update(t,r){return this.http.put(`${s}/${t}`,r).pipe(m(o=>(o.id===this.accountValue.id&&(o=c(c({},this.accountValue),o),this.accountSubject.next(o)),o)))}delete(t){return this.http.delete(`${s}/${t}`).pipe($(()=>{this.accountValue&&t===this.accountValue.id&&this.logout()}))}startRefreshTokenTimer(){if(this.accountValue&&this.accountValue.jwtToken){let t=JSON.parse(atob(this.accountValue.jwtToken.split(".")[1]));if(t&&t.exp){let o=new Date(t.exp*1e3).getTime()-Date.now()-60*1e3;this.refreshTokenTimeout=setTimeout(()=>this.refreshToken().subscribe(),o)}else console.error("Invalid JWT token or missing expiration time."),this.logout()}}stopRefreshTokenTimer(){clearTimeout(this.refreshTokenTimeout)}static{this.\u0275fac=function(r){return new(r||e)(a(d),a(p))}}static{this.\u0275prov=n({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var k=function(e){return e.User="User",e.Admin="Admin",e}(k||{});var u=class{constructor(w){Object.assign(this,w)}},h=function(e){return e[e.Success=0]="Success",e[e.Error=1]="Error",e[e.Info=2]="Info",e[e.Warning=3]="Warning",e}(h||{});var N=(()=>{class e{constructor(){this.subject=new b,this.defaultId="default-alert"}onAlert(t=this.defaultId){return this.subject.asObservable().pipe(j(r=>r&&r.id===t))}success(t,r){this.alert(new u(l(c({},r),{type:h.Success,message:t})))}error(t,r){this.alert(new u(l(c({},r),{type:h.Error,message:t})))}info(t,r){this.alert(new u(l(c({},r),{type:h.Info,message:t})))}warn(t,r){this.alert(new u(l(c({},r),{type:h.Warning,message:t})))}alert(t){t.id=t.id||this.defaultId,t.autoClose=t.autoClose===void 0?!0:t.autoClose,this.subject.next(t)}clear(t=this.defaultId){this.subject.next(new u({id:t}))}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=n({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var K=(()=>{class e{constructor(t){this.http=t}getAll(){return this.http.get(`${i.apiUrl}/employees`)}getById(t){return this.http.get(`${i.apiUrl}/employees/${t}`)}create(t){return this.http.post(`${i.apiUrl}/employees`,t)}update(t,r){return this.http.put(`${i.apiUrl}/employees/${t}`,r)}delete(t){return this.http.delete(`${i.apiUrl}/employees/${t}`)}static{this.\u0275fac=function(r){return new(r||e)(a(p))}}static{this.\u0275prov=n({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Q=(()=>{class e{constructor(t){this.http=t}getAll(){return this.http.get(`${i.apiUrl}/departments`)}getById(t){return this.http.get(`${i.apiUrl}/departments/${t}`)}create(t){return this.http.post(`${i.apiUrl}/departments`,t)}update(t,r){return this.http.put(`${i.apiUrl}/departments/${t}`,r)}delete(t){return this.http.delete(`${i.apiUrl}/departments/${t}`)}static{this.\u0275fac=function(r){return new(r||e)(a(p))}}static{this.\u0275prov=n({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Z=(()=>{class e{constructor(t){this.http=t}getByEmployeeId(t){return this.http.get(`${i.apiUrl}/workflows/employee/${t}`)}create(t){return this.http.post(`${i.apiUrl}/workflows`,t)}updateStatus(t,r){return this.http.put(`${i.apiUrl}/workflows/${t}/status`,{status:r})}static{this.\u0275fac=function(r){return new(r||e)(a(p))}}static{this.\u0275prov=n({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var st=(()=>{class e{constructor(t,r){this.router=t,this.accountService=r}canActivate(t,r){let o=this.accountService.accountValue;return o?t.data.roles&&!t.data.roles.includes(o.role)?(this.router.navigate(["/"]),!1):!0:(this.router.navigate(["/account/login"],{queryParams:{returnUrl:r.url}}),!1)}static{this.\u0275fac=function(r){return new(r||e)(a(d),a(I))}}static{this.\u0275prov=n({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();export{i as a,I as b,h as c,k as d,N as e,K as f,Q as g,Z as h,st as i};
